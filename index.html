<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <link href="http://gmpg.org/xfn/11" rel="profile">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Raúl Ávila
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/atom+xml" title="Raúl Ávila" href="/atom.xml">

</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <h1 class="masthead-title">
          <a href="/" title="Home">Raúl Ávila</a>
        </h1>

            <small><a href="/sobre-mi">Sobre mí</a></small>
            &nbsp;&nbsp;&nbsp;
            <small><a href="/archivos">Archivos</a></small>
            &nbsp;&nbsp;&nbsp;
            <small><a href="/atom.xml">Feed</a></small>            
      </header>

      <main>
        <div class="posts">
  
  <article class="post">
    <h1 class="post-title">
      <a href="/2015/02/fowler-refactoring-1">
        Fowler's Refactoring. Un clásico con errores (parte 1)
      </a>
    </h1>

    <time datetime="2015-02-08T00:00:00+00:00" class="post-date index-date">08/02/2015</time>    

    <p><img src="/public/pictures/refactoring_fowler.jpg" alt="Refactoring, el libro" /></p>

<p>El libro <a href="http://www.amazon.es/Refactoring-Improving-Design-Existing-Technology/dp/0201485672/ref=sr_1_1?ie=UTF8&amp;qid=1423418116&amp;sr=8-1&amp;keywords=Refactoring">“Refactoring: Improving the design of existing code”</a>, es un clásico absoluto de la Ingeniería del Software. Cualquier desarrollador experimentado debe conocer forzosamente muchas de las refactorizaciones propuestas en el libro. El propio autor las tiene recogidas online en <a href="http://refactoring.com/catalog/">este catálogo</a>, aunque sin entrar en muchos detalles (hay que seguir vendiendo el libro, cosa totalmente lícita). En pocas palabras, refactorizar consiste en modificar el código sin que la funcionalidad se vea afectada, y es algo totalmente necesario para la buena salud de nuestro código.</p>

<p>Recientemente he terminado de leer este compendio de técnicas para mejorar el código que desarrollamos, y la valoración general es muy positiva. Me ha servido para plantearme ciertas cosas que hago o dejo de hacer a diario, y diría que soy un poco mejor programador que antes de leerlo. Por supuesto lo recomendaría a cualquiera.</p>

<p>Sin embargo, diría que el tiempo no le ha sentado demasiado bien a este libro, y necesitaría de una segunda edición con relativa urgencia. Para empezar, estamos hablando de una obra publicada en 1999, y con todos los ejemplos basados en Java 1.2. Mucho ha llovido desde entonces, para entendernos en aquella versión de Java no existían ni las <a href="http://docs.oracle.com/javase/tutorial/java/javaOO/enum.html">enums</a>, ni los <a href="http://docs.oracle.com/javase/tutorial/java/generics/why.html">generics</a>, herramientas del lenguaje totalmente fundamentales hoy día, por poner un par de ejemplos. Varios de los refactorings carecen totalmente de sentido desde una perspectiva actual.</p>

<p>Pero en esta serie de artículos pretendo comentar errores que me han llamado poderosamente la atención, dejando de lado aspectos relativos a versiones más o menos antiguas del lenguaje. Estoy seguro de que el propio autor los corregiría si fuera posible. No es mi intención despreciar el trabajo de Fowler, por supuesto, yo a su lado soy un insecto, solo considero importante resaltar ciertas cosas que no estaría nada bien quedaran fijadas como buenas prácticas de programación por aparecer en los ejemplos del libro.</p>

<p>Si algún lector considera que me falta razón en alguno de los puntos, estaré encantado en comentarlo. Empezaré por el único fallo indiscutible se mire por donde se mire.</p>

<h3 id="clase-inmutable">¿Clase inmutable?</h3>

<p>En el refactoring “Introduce parameter object” (pág 295) aparece un ejemplo muy desafortunado de <a href="http://howtodoinjava.com/2012/10/28/how-to-make-a-java-class-immutable/">clase inmutable</a>:</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DateRange</span> <span class="o">{</span>
    
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Date</span> <span class="n">start</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Date</span> <span class="n">end</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">DateRange</span><span class="o">(</span><span class="n">Date</span> <span class="n">start</span><span class="o">,</span> <span class="n">Date</span> <span class="n">end</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">start</span> <span class="o">=</span> <span class="n">start</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">end</span> <span class="o">=</span> <span class="n">end</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Date</span> <span class="nf">getStart</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">start</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Date</span> <span class="nf">getEnd</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">end</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></div>

<p>¿Por qué es desafortunado este ejemplo? ¡Porque esta clase no es inmutable en absoluto! Veamos:</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testInmutableClass</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="n">Date</span> <span class="n">start</span> <span class="o">=</span> <span class="n">parse</span><span class="o">(</span><span class="s">&quot;2001-01-01&quot;</span><span class="o">);</span>
    <span class="n">Date</span> <span class="n">end</span> <span class="o">=</span> <span class="n">parse</span><span class="o">(</span><span class="s">&quot;2001-01-02&quot;</span><span class="o">);</span>

    <span class="n">DateRange</span> <span class="n">range</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">DateRange</span><span class="o">(</span><span class="n">start</span><span class="o">,</span> <span class="n">end</span><span class="o">);</span>

    <span class="n">Date</span> <span class="n">dateAux</span> <span class="o">=</span> <span class="n">range</span><span class="o">.</span><span class="na">getEnd</span><span class="o">();</span>
    
    <span class="c1">//Modifies end date!</span>
    <span class="n">dateAux</span><span class="o">.</span><span class="na">setTime</span><span class="o">(</span><span class="mi">123123</span><span class="o">);</span>

    <span class="n">assertThat</span><span class="o">(</span><span class="n">range</span><span class="o">.</span><span class="na">getStart</span><span class="o">()).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="n">parse</span><span class="o">(</span><span class="s">&quot;2001-01-01&quot;</span><span class="o">))</span> <span class="o">;</span>
    
    <span class="c1">//End date of the range modified!</span>
    <span class="n">assertThat</span><span class="o">(</span><span class="n">range</span><span class="o">.</span><span class="na">getEnd</span><span class="o">()).</span><span class="na">isNotEqualTo</span><span class="o">(</span><span class="n">parse</span><span class="o">(</span><span class="s">&quot;2001-01-02&quot;</span><span class="o">));</span>
<span class="o">}</span></code></pre></div>

<p>Para que una clase sea inmutable no basta con que sus atributos sean final y no proveer setters, si dichos atributos contienen referencias a objetos, dichos objetos han de ser también inmutables, cosa que no ocurre con la clase Date (¡cuántos quebraderos de cabeza nos ha dado esta clase a los desarrolladores Java!).</p>

<p>Si queremos usar de todas todas la clase Date para limitar los rangos de DateRange, la forma adecuada de que DateRange sea inmutable es crear “defensive copies” en los getters. Esta técnica está explicada estupendamente en el libro <a href="http://www.amazon.es/Effective-Java-Programming-Language-Guide/dp/0321356683/ref=sr_1_1?ie=UTF8&amp;qid=1423422393&amp;sr=8-1&amp;keywords=Effective+Java">“Effective Java”</a> de Joshua Bloch. Consiste en crear una copia del objeto a devolver en lugar del propio objeto. de esta forma el cliente no tiene una referencia de la instancia contenida en la clase inmutable, sino una copia, y puede hacer lo que quiera con ella, ya que la instancia original seguirá encapsulada en dicha clase inmutable:</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DateRangeInmutable</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Date</span> <span class="n">start</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Date</span> <span class="n">end</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">DateRangeInmutable</span><span class="o">(</span><span class="n">Date</span> <span class="n">start</span><span class="o">,</span> <span class="n">Date</span> <span class="n">end</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">start</span> <span class="o">=</span> <span class="n">start</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">end</span> <span class="o">=</span> <span class="n">end</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Date</span> <span class="nf">getStart</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Date</span><span class="o">(</span><span class="n">start</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">Date</span> <span class="nf">getEnd</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Date</span><span class="o">(</span><span class="n">end</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></div>

<p>En el siguiente test se puede comprobar como la clase es realmente inmutable:</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testInmutableClass</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="n">Date</span> <span class="n">start</span> <span class="o">=</span> <span class="n">parse</span><span class="o">(</span><span class="s">&quot;2001-01-01&quot;</span><span class="o">);</span>
    <span class="n">Date</span> <span class="n">end</span> <span class="o">=</span> <span class="n">parse</span><span class="o">(</span><span class="s">&quot;2001-01-02&quot;</span><span class="o">);</span>

    <span class="n">DateRange</span> <span class="n">range</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">DateRange</span><span class="o">(</span><span class="n">start</span><span class="o">,</span> <span class="n">end</span><span class="o">);</span>

    <span class="n">Date</span> <span class="n">dateAux</span> <span class="o">=</span> <span class="n">range</span><span class="o">.</span><span class="na">getEnd</span><span class="o">();</span>

    <span class="n">dateAux</span><span class="o">.</span><span class="na">setTime</span><span class="o">(</span><span class="mi">123123</span><span class="o">);</span>

    <span class="n">assertThat</span><span class="o">(</span><span class="n">range</span><span class="o">.</span><span class="na">getStart</span><span class="o">()).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="n">parse</span><span class="o">(</span><span class="s">&quot;2001-01-01&quot;</span><span class="o">))</span> <span class="o">;</span>

    <span class="c1">//End date of the range is not modified!</span>
    <span class="n">assertThat</span><span class="o">(</span><span class="n">range</span><span class="o">.</span><span class="na">getEnd</span><span class="o">()).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="n">parse</span><span class="o">(</span><span class="s">&quot;2001-01-02&quot;</span><span class="o">));</span>
<span class="o">}</span></code></pre></div>

<p>Prefiero dejarlo aquí por hoy. Me he dado cuenta de que explicar cada ejemplo con detalle lleva su tiempo, así que iré desgranando los diferentes puntos en posteriores artículos.</p>

<p>Subiré todos los ejemplos en <a href="https://github.com/raulavila/fowlers-refactoring-errors">este repositorio de GitHub</a>.</p>


    
  </article>

  
  <article class="post">
    <h1 class="post-title">
      <a href="/2015/02/atajos-teclado-ide">
        Atajos de teclado en IDE's
      </a>
    </h1>

    <time datetime="2015-02-01T00:00:00+00:00" class="post-date index-date">01/02/2015</time>    

    <p>En mi <a href="/2015/01/entornos-integrados-desarrollo">anterior post</a> hablé de IDE’s y las diferentes alternativas que hay en el mercado. Mi intención inicial con ese post era hablar de atajos de teclado, pero me extendí demasiado con la introducción y preferí terminar ese hilo para hablar de ello más adelante.</p>

<p>En mi opinión, ningún desarrollador profesional puede proclamarse como tal si no domina al menos una gran parte de los atajos de teclado que detallaré a continuación. El desarrollo de software debe estar centrado en producir una buena arquitectura y un código mantenible y modular. Un código con estas características no es generado a la primera, requiriendo de un proceso sucesivo de depuración y refactorización. Las herramientas ofrecidas por los IDE’s facilitan muchísimo esta labor, y me atrevería a decir que no conocerlas dificulta el proceso a seguir para llevar a cabo las acciones necesarias que nos llevarán a cumplir con el objetivo de entregar un código <a href="http://es.wikipedia.org/wiki/SOLID_%28object-oriented_design%29">SOLID</a>. </p>


    
      <a href="/2015/02/atajos-teclado-ide">[...Leer más...]</a>
    
  </article>

  
  <article class="post">
    <h1 class="post-title">
      <a href="/2015/01/entornos-integrados-desarrollo">
        Entornos integrados de desarrollo (IDE)
      </a>
    </h1>

    <time datetime="2015-01-31T00:00:00+00:00" class="post-date index-date">31/01/2015</time>    

    <p><img src="/public/pictures/screenshot_intellij.png" alt="IntelliJ Idea" /></p>

<p>Los entornos integrados de desarrollo (IDE) son una herramienta fundamental en el desarrollo de software profesional (y no profesional, diría yo). La asistencia que ofrecen para la generación de código, navegación entre archivos, depuración, despliegues, integración con control de versiones, etc, los hace imprescindibles para cumplir con los mínimos de productividad que exige un mercado tan competitivo como el actual.</p>


    
      <a href="/2015/01/entornos-integrados-desarrollo">[...Leer más...]</a>
    
  </article>

  
  <article class="post">
    <h1 class="post-title">
      <a href="/2015/01/como-hice-el-blog">
        Cómo hice el blog
      </a>
    </h1>

    <time datetime="2015-01-26T00:00:00+00:00" class="post-date index-date">26/01/2015</time>    

    <p><img src="/public/pictures/jekyll-github.png" alt="Jekyll y GitHub" /></p>

<p>En Internet hay un montón de alternativas para crear un blog propio. Cuando me propuse crear una web personal tuve claro desde el principio que los contenidos generados deberían ser míos. Me explico: en ocasiones, al utilizar plataformas como <a href="http://www.blogger.com">blogger</a> ocurre que los posts quedan alojados en un servidor sobre el que no tienes ningún control. Y así te puedes encontrar con que nuestro amigo Google ha decidido que no estás cumpliendo las <em>condiciones de uso</em> y cerrártelo de buenas a primeras. En la misma liga juegan los blogs de <a href="https://es.wordpress.com/">WordPress</a>, por ejemplo.</p>


    
      <a href="/2015/01/como-hice-el-blog">[...Leer más...]</a>
    
  </article>

  
  <article class="post">
    <h1 class="post-title">
      <a href="/2015/01/hello-world">
        Hello World!
      </a>
    </h1>

    <time datetime="2015-01-25T00:00:00+00:00" class="post-date index-date">25/01/2015</time>    

    <p>Desde hace tiempo me lleva rondando por la cabeza la idea de tener una página personal / blog. La verdad es que hasta hace poco consideraba que no tenía demasiadas cosas que aportar a la comunidad, pero me he dado cuenta de que <a href="/sobre-mi">cualquiera</a> en este mundillo tiene algo que decir.</p>


    
      <a href="/2015/01/hello-world">[...Leer más...]</a>
    
  </article>

  
</div>

<div class="pagination">
  
    <span class="pagination-item older">Anteriores</span>
  
  
    <span class="pagination-item newer">Siguientes</span>
  
</div>

        
      </main>

      <footer class="footer">
        <small>
          &copy; <time datetime="2015">2015</time> Raúl Ávila. Blog creado con <a href="http://jekyllrb.com">Jekyll</a>. Plantilla basada en <a href="http://getpoole.com">Poole</a>.<br>
        </small>
      </footer>
    </div>

  <script>
window.twttr=(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);t._e=[];t.ready=function(f){t._e.push(f);};return t;}(document,"script","twitter-wjs"));
</script>

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58942569-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>
